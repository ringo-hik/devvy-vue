<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" href="<%= BASE_URL %>favicon.ico">
    <title>Main Service with FloatChat</title>
  </head>
  <body>
    <noscript>
      <strong>We're sorry but this app doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
    </noscript>
    
    <!-- 메인 앱 컨테이너 -->
    <div id="app"></div>
    
    <!-- FloatChat 독립 컨테이너 -->
    <div id="float-chat-app"></div>
    
    <!-- FloatChat 스타일 (독립 로드) -->
    <link rel="stylesheet" href="/css/FloatChat.css">
    
    <script>
      /**
       * 레거시 환경용 FloatChat 직접 로드
       */
      
      // DOM 로드 완료 후 FloatChat 초기화
      document.addEventListener('DOMContentLoaded', function() {
        // FloatChat 컨테이너 확인
        const floatChatContainer = document.getElementById('float-chat-app');
        if (!floatChatContainer) {
          console.error('[FloatChat] 컨테이너를 찾을 수 없습니다.');
          return;
        }

        // 메인 앱 로드 완료 후 FloatChat 로드
        window.addEventListener('load', function() {
          // 동적으로 FloatChat 스크립트 로드
          const script = document.createElement('script');
          script.src = '/js/floatChatApp.js';
          script.onload = function() {
            console.log('✅ FloatChat 스크립트 로드 완료');
            
            // FloatChat 초기화
            if (window.FloatChatApp && window.FloatChatApp.init) {
              const instance = window.FloatChatApp.init();
              console.log('✅ FloatChat 초기화:', instance ? '성공' : '실패');
            }
          };
          script.onerror = function() {
            console.error('❌ FloatChat 스크립트 로드 실패');
          };
          
          document.head.appendChild(script);
        });
      });
      
      // 전역 FloatChat 제어 함수
      window.toggleFloatChat = function() {
        const container = document.getElementById('float-chat-app');
        if (container) {
          container.style.display = container.style.display === 'none' ? 'block' : 'none';
          console.log('FloatChat 표시 상태:', container.style.display !== 'none' ? '보임' : '숨김');
        }
      };
    </script>
  </body>
</html>